mutate(
bool_gba = case_when(
AGLOMERADO==33 | AGLOMERADO==32 ~ 1,
TRUE ~ 0
),
n_60_75 = n_v_60_75 + n_f_60_75,
n_75 = n_v_75 + n_f_75,
unipersonales = case_when(
IX_TOT == 1 ~ 1,
TRUE ~ 0
)
) %>%
mutate(
bool_60_75 = case_when(
n_60_75 > 0 ~ 1,
TRUE ~ 0),
bool_75= case_when(
n_75 > 0 ~ 1,
TRUE ~ 0),
sin_may = case_when(
bool_60_75 | bool_75 ~ 0,
TRUE ~ 1)
) %>%
mutate(
bool_mujeres = case_when(
sin_may ~ 9,
n_f_60_75 > 0 | n_f_75 > 0 ~  1,
TRUE ~ 0)
);
hog2 <- hog2 %>%
mutate(
bool_gba = case_when(
AGLOMERADO==33 | AGLOMERADO==32 ~ 1,
TRUE ~ 0
),
n_60_75 = n_v_60_75 + n_f_60_75,
n_75 = n_v_75 + n_f_75,
unipersonales = case_when(
IX_TOT == 1 ~ 1,
TRUE ~ 0
)
) %>%
mutate(
bool_60_75 = case_when(
n_60_75 > 0 ~ 1,
TRUE ~ 0),
bool_75= case_when(
n_75 > 0 ~ 1,
TRUE ~ 0),
sin_may = case_when(
bool_60_75 | bool_75 ~ 0,
TRUE ~ 1)
)
table(hog2['sin_may'])
hog2 <- hog2 %>%
mutate(
bool_gba = case_when(
AGLOMERADO==33 | AGLOMERADO==32 ~ 1,
TRUE ~ 0
),
n_60_75 = n_v_60_75 + n_f_60_75,
n_75 = n_v_75 + n_f_75,
unipersonales = case_when(
IX_TOT == 1 ~ 1,
TRUE ~ 0
)
) %>%
mutate(
bool_60_75 = case_when(
n_60_75 > 0 ~ 1,
TRUE ~ 0),
bool_75= case_when(
n_75 > 0 ~ 1,
TRUE ~ 0),
sin_may = case_when(
bool_60_75 | bool_75 ~ 0,
TRUE ~ 1)
) %>%
mutate(
bool_mujeres = case_when(
sin_may == 1 ~ 9,
n_f_60_75 > 0 | n_f_75 > 0 ~ 1,
TRUE ~ 0)
);
table(hog2['bool_mujeres'])
hog2 = expss::apply_labels(hog2, sin_may = "Hogar sin adultos mayores", sin_may = c('Hogares con adultos mayores' = 0,
'Hogares sin adultos mayores' = 1))
table(hog2['sin_may'])
hog2 <- hog2 %>% organize_labels();
View(hog2)
calculate_tabulates(base = hog2,
x = "bool_gba",
weights = "PONDERA");
hog3 <- hog2 %>% filter(bool_gba =1 );
calculate_tabulates(base = hog2,
x = "bool_60_75",
weights = "PONDERA");
calculate_tabulates(base = hog2,
x = "bool_75",
weights = "PONDERA");
calculate_tabulates(base = hog2,
x = "sin_may",
weights = "PONDERA");
calculate_tabulates(base = hog2,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA");
hog3 <- hog2 %>% filter(bool_gba == 1 );
calculate_tabulates(base = hog3,
x = "bool_60_75",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "bool_75",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "sin_may",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA");
hog3 <- hog2 %>% filter(bool_gba == 1 );
calculate_tabulates(base = hog3,
x = "bool_60_75",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "bool_75",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "sin_may",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA");
calculate_tabulates(base = hog3,
x = "bool_60_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "sin_may",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog2,
x = "bool_gba",
weights = "PONDERA",
add.totals = 'both');
tabout(
calculate_tabulates(base = hog3,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA",
add.totals = 'both'))
calculate_tabulates(base = hog3,
x = "sin_may",
y = "ADECCFR",
weights = "PONDIH",
add.totals = 'both')
calculate_tabulates(base = hog3,
x = "sin_may",
y = "ADECCFR",
weights = "PONDIH",
add.totals = 'both',
add.percentage = 'both' )
calculate_tabulates(base = hog3,
x = "sin_may",
y = "ADECCFR",
weights = "PONDIH",
add.totals = 'both',
add.percentage = 'both' )
calculate_tabulates(base = hog3,
x = "sin_may",
y = "ADECCFR",
weights = "PONDIH",
add.totals = 'both',
add.percentage = 'row' )
calculate_tabulates(base = hog3,
x = "sin_may",
y = "ADECCFR",
weights = "PONDIH",
#add.totals = 'both',
add.percentage = 'both' )
factor(hog3['ADECCFR'])
levels(hog3['ADECCFR'])
levels(hog3$ADECCFR)
levels(hog3$ADECCFR)
hog3$ADECCFR
calculate_tabulates(base = hog3,
y = "sin_may",
x = "ADECCFR",
weights = "PONDIH",
#add.totals = 'both',
add.percentage = 'both' )
calculate_tabulates(base = hog3,
y = "sin_may",
x = "ADECCFR",
weights = "PONDIH",
#add.totals = 'both',
add.percentage = 'row' )
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
y = "sin_may",
x = "ADECCFR",
weights = "PONDIH",
#add.totals = 'both',
add.percentage = 'row' )
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
y = "sin_may",
x = "ADECCFR",
weights = "PONDERA",
#add.totals = 'both',
add.percentage = 'row' )
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
y = "sin_may",
x = "ADECCFR",
weights = "PONDIH",
#add.totals = 'both',
add.percentage = 'col' )
table(filter(hog2, AGLOMERADO == 32)$ADECCFR);
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
x = "ADECCFR",
weights = "PONDIH",
add.totals = 'both' )
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
x = "ADECCFR",
weights = "PONDIH",
add.totals = 'both',
add.percentage = 'col')
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
x = "ADECCFR",
weights = "PONDIH",
add.percentage = 'col')
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
x = "ADECCFR",
weights = "PONDERA",
add.percentage = 'col')
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
x = "ADECCFR",
weights = "PONDIH",
add.percentage = 'col')
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32),
x = "ADECCFR",
weights = "PONDIH")
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32 | AGLOMERADO == 33),
x = "ADECCFR",
y = "AGLOMERADO"
weights = "PONDIH")
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32 | AGLOMERADO == 33),
x = "ADECCFR",
y = "AGLOMERADO",
weights = "PONDIH")
str(hog3)
calculate_tabulates(base = filter(hog2, AGLOMERADO == 32 | AGLOMERADO == 33),
x = "GDECCFR",
y = "AGLOMERADO",
weights = "PONDIH")
hog2 = expss::apply_labels(hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0,                                                                                     'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0,                                                                                     'Tiene adultos entre 60 y 75' = 1),
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1),
);
hog2 = expss::apply_labels(hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0,                                                                                     'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0,                                                                                     'Tiene adultos entre 60 y 75' = 1),
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1),
);
View(hog2)
hog2 = expss::apply_labels(hog2, sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0,                                                                                     'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = "Hogar Unipersonal",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = "Hogar Unipersonal",
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0,                                                                                     'Tiene adultos entre 60 y 75' = 1),
bool_75 = 'Hogares con mayores de 75',
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = 'Mujeres mayores',
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1),
);
hog2 = expss::apply_labels(
hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0, 'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = "Hogar Unipersonal",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = "Hogar Unipersonal",
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0, 'Tiene adultos entre 60 y 75' = 1),
bool_75 = 'Hogares con mayores de 75',
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = 'Mujeres mayores',
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1),
);
hog2 = expss::apply_labels(
hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0, 'Hogares sin adultos mayores' = 1),
unipersonales = "Hogar Unipersonal",
unipersonales = c('Hogares multipersonales' = 0, 'Hogares unipersonales' = 1),
bool_60_75 = "Hogar Unipersonal",
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0, 'Tiene adultos entre 60 y 75' = 1),
bool_75 = 'Hogares con mayores de 75',
bool_75 = c('No tiene adultos de mas de 75' = 0, 'Tiene adultos de mas de 75' = 1),
bool_mujeres = 'Mujeres mayores',
bool_mujeres = c('No tiene mujeres de mas 60' = 0, 'Tiene mujeres de mas de 60' = 1),
);
hog2 = expss::apply_labels(
hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0, 'Hogares sin adultos mayores' = 1),
);
hog2 = expss::apply_labels(hog2, sin_may = "Hogar sin adultos mayores", sin_may = c('Hogares con adultos mayores' = 0,
'asd' =1))
hog2 = expss::apply_labels( hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0, 'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = "Hogar Unipersonal",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = "Hogar Unipersonal",
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0, 'Tiene adultos entre 60 y 75' = 1),
bool_75 = 'Hogares con mayores de 75',
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = 'Mujeres mayores',
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1),
);
hog2 = expss::apply_labels( hog2, sin_may = "Hogar sin adultos mayores", sin_may = c('Hogares con adultos mayores' = 0, 'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = "Hogar Unipersonal",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = "Hogar Unipersonal",
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0, 'Tiene adultos entre 60 y 75' = 1),
bool_75 = 'Hogares con mayores de 75',
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = 'Mujeres mayores',
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1)
);
hog2 = expss::apply_labels( hog2,
sin_may = "Hogar sin adultos mayores",
sin_may = c('Hogares con adultos mayores' = 0, 'Hogares sin adultos mayores' = 1),
n_v_60_75 = "sum(bool_v_60_75)",
n_f_60_75 = "sum(bool_f_60_75)",
n_v_75 = "sum(bool_v_75)",
n_f_75 = "sum(bool_f_75))",
n_60_75 = "n_v_60_75 + n_f_60_75",
n_75 = "n_v_75 + n_f_75",
unipersonales = "Hogar Unipersonal",
unipersonales = c('Hogares multipersonales' = 0,                                                                                     'Hogares unipersonales' = 1),
bool_60_75 = "Hogar Unipersonal",
bool_60_75 = c('No tiene adultos entre 60 y 75' = 0, 'Tiene adultos entre 60 y 75' = 1),
bool_75 = 'Hogares con mayores de 75',
bool_75 = c('No tiene adultos de mas de 75' = 0,                                                                                     'Tiene adultos de mas de 75' = 1),
bool_mujeres = 'Mujeres mayores',
bool_mujeres = c('No tiene mujeres de mas 60' = 0,                                                                                     'Tiene mujeres de mas de 60' = 1)
);
calculate_tabulates(base = hog2,
x = "bool_gba",
weights = "PONDERA",
add.totals = 'both');
hog3 <- hog2 %>% filter(bool_gba == 1 );
calculate_tabulates(base = hog3,
x = "bool_60_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "sin_may",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_mujeres",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "unipersonales",
y = "sin_may",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog2,
x = "bool_gba",
weights = "PONDERA",
add.totals = 'both');
hog3 <- hog2 %>% filter(bool_gba == 1 );
calculate_tabulates(base = hog3,
x = "bool_60_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "sin_may",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_60_75",
y = "bool_75",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "bool_mujeres",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
x = "unipersonales",
y = "sin_may",
weights = "PONDERA",
add.totals = 'both');
calculate_tabulates(base = hog3,
y = "sin_may",
x = "GDECCFR",
weights = "PONDIH")
calculate_tabulates(base = hog3,
x = "sin_may",
y = "GDECCFR",
weights = "PONDIH")
quantile(hog3$IPCF, c(0.25, 0.5, 0.75))
source('~/covid/publica/fasecero.github.io/scripts/grafico10.r')
source('~/covid/rankingdemuertes.R')
grRank2
paisesAmericaDelSur <- list('Argentina', 'Chile', 'Brazil',  'Ecuador', 'Colombia', 'Peru', 'Mexico', 'Paraguay', 'Bolivia');
#graficos latam
grLatam1 <- ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories %in% paisesAmericaDelSur, ],
mapping = aes(
x = realDate,
y = deathsAcum,
color = countriesAndTerritories)) +
geom_line() +
#geom_point() +
#scale_x_log10(labels =   scales::comma_format()) +
scale_y_continuous(labels = scales::comma_format()) +
scale_x_date(breaks = pretty_breaks(10)) +
theme(legend.position="bottom", legend.title  = element_blank()) +
labs(x = element_blank(), y = 'Muertes', caption = caption)  +
coord_cartesian(xlim = c(as.Date('2020-04-01'), as.Date(ultimaFecha)));
grLatam2 <- ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories %in% paisesAmericaDelSur, ],
mapping = aes(
x = realDate,
y = deathsAcum / popData2019 * 100000,
color = countriesAndTerritories)) +
geom_line() +
#geom_point() +
#scale_x_log10(labels =   scales::comma_format()) +
scale_y_continuous(labels = scales::comma_format()) +
scale_x_date(breaks = pretty_breaks(10)) +
theme(legend.position="bottom", legend.title  = element_blank()) +
labs(x = element_blank(), y = 'Muertes cada 100.000 habitantes', caption = caption) +
coord_cartesian(xlim = c(as.Date('2020-04-01'), as.Date(ultimaFecha)));
grLatam1 <- grLatam1 + labs(caption = element_blank());
grMuertesLA <- grLatam1 + grLatam2 + plot_annotation(
title = 'Comparación cantidad de muertes por Covid-19 en países de latinoamérica'
#subtitle = 'These 3 plots will reveal yet-untold secrets about our beloved data-set',
#caption = 'Disclaimer: None of these plots are insightful'
);
ggsave(paste(pathGraficos, '/', 'muertesLA', ultimaFecha, ".png", sep = ""), plot = grMuertesLA, width = grWidth, height = grHeight*2/3, dpi = grDpi, units = grUnits, device= grDevice)
