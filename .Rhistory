source('~/covid/publica/fasecero.github.io/scripts/grafico10.r')
source('~/covid/prediccion.r')
graficoProyeccion
source('~/covid/publica/fasecero.github.io/scripts/grafico10.r')
colores
colores[4] <- 'red';
colored
colores
source('~/covid/publica/fasecero.github.io/scripts/grafico10.r')
source('~/covid/publica/fasecero.github.io/scripts/grafico10.r')
source('~/covid/prediccion.r')
graficoProyeccion
source('~/covid/prediccion.r')
graficoProyeccion
#grafico argentina EJE SECUNDARIO
datoscovidok$tasaDiaria <- with(datoscovidok, (casesAcum/(casesAcum - casesAcumSemana))^(1/7)-1);
require("ggrepel");
set.seed(42);
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank()) +
geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
ggplotly(gra10)
#grafico argentina EJE SECUNDARIO
datoscovidok$tasaDiaria <- with(datoscovidok, (casesAcum/(casesAcum - casesAcumSemana))^(1/7)-1);
require("ggrepel");
set.seed(42);
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank()) +
geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank()) +
#geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
as}
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank())
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
#geom_point(aes(y=casesAcum, colour = 'Casos')) +
geom_point() +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank())
#geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
)
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
geom_point(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank())
#geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
geom_point(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank()) +
coord_cartesian(xlim = c(as.Date('2020-03-15'), max(ultimaFecha)))
#geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
geom_point(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank()) +
labs(title.y.axis = 'Casos confirmados') +
coord_cartesian(xlim = c(as.Date('2020-03-15'), max(ultimaFecha)))
#geom_text_repel(aes(y = tasaDiaria*10000, label = sprintf("%1.1f%%", 100*tasaDiaria), colour = 'Tasa'), vjust = "inward", hjust = "inward", size=3)
ggplot(
data = datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina',],
mapping = aes(
x = realDate
)) +
geom_line(aes(y = casesAcum, colour = 'Casos')) +
geom_line(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
geom_point(aes(y=casesAcum, colour = 'Casos')) +
geom_point(aes(y = tasaDiaria*10000, colour = 'Tasa')) +
scale_y_continuous(sec.axis = sec_axis(~./10000, name = "Tasa", labels = scales::percent_format(accuracy = 1))) +
theme(
legend.position="bottom",
legend.title  = element_blank()) +
labs(y = 'Casos confirmados') +
coord_cartesian(xlim = c(as.Date('2020-03-15'), max(ultimaFecha)))
graficoProyeccion
x <- datoscovidok[datoscovidok$countriesAndTerritories == Argentina & datoscovidok$realDate == ultimaFecha,];
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
x <- datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina' & datoscovidok$realDate == ultimaFecha,];
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina' & datoscovidok$realDate == ultimaFecha,];
calcularPendiente <- function(x) {
#sum(subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate']), select = 'cases')))
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
}
datoscovidok$pendientePrediccion <- apply(datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina' & datoscovidok$realDate == ultimaFecha,], 1, calcularPendiente);
model
View(datoscovidok)
model$coefficients
model$coefficients['realDato']
model$coefficients['realDate']
model$coefficients['realDate']
model$coefficients['realDate']['realDate']
model$coefficients['realDate']['realDate']
calcularPendiente <- function(x) {
#sum(subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate']), select = 'cases')))
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
model$coefficients['realDate'];
}
datoscovidok$pendientePrediccion <- apply(datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina' & datoscovidok$realDate == ultimaFecha,], 1, calcularPendiente);
datoscovidok$pendientePrediccion <- NULL
calcularPendiente <- function(x) {
#sum(subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate']), select = 'cases')))
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
return(model$coefficients['realDate']);
}
datoscovidok$pendientePrediccion <- apply(datoscovidok[datoscovidok$countriesAndTerritories == 'Argentina' & datoscovidok$realDate == ultimaFecha,], 1, calcularPendiente);
datoscovidok$pendientePrediccion <- NULL
calcularPendiente <- function(x) {
#sum(subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate']), select = 'cases')))
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
return(model$coefficients['realDate']);
}
datoscovidok$pendientePrediccion <- apply(datoscovidok, 1, calcularPendiente);
summary(datoscovidok$pendientePrediccion)
calcularPendiente <- function(x) {
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
return(model$coefficients['realDate']);
}
datoscovidok$pendientePrediccion <- apply(datoscovidok, 1, calcularPendiente);
calcularPendiente <- function(x) {
model <- lm(diasDuplicar ~ realDate, data = subset(datoscovidok, (geoId == x['geoId'] & realDate <= x['realDate'] & realDate > as.Date(x['realDate']) - 10)));
return(model$coefficients['realDate']);
}
datoscovidok$pendientePrediccion <- apply(head(datoscovidok, n=10), 1, calcularPendiente);
